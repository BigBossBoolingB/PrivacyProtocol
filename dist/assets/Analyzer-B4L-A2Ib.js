import{j as e}from"./ui-components-BzeP3NEV.js";import{a,L as t,i as s}from"./react-vendor-pFbjcDKR.js";import{C as r,a as i,b as l,c as n,B as o,P as c}from"./badge-BMwPockq.js";import{c as d,e as m,m as y,B as p,f as g,P as x,R as u,a as h,T as b,I as f,g as j,S as _,X as w,d as v,s as N,h as k,A,b as C,r as T}from"./index-DSn6Arvu.js";import{I as P,D as S,B as E,S as R,T as D}from"./input-DoXZiO2D.js";import{L}from"./label-DqmJy21e.js";import{A as U,a as F}from"./alert-BeifeO2q.js";import{F as z,S as I}from"./SubscriptionModal-DcnuW8ey.js";import{T as O}from"./target-ClL8scOb.js";import{E as W}from"./dialog-B-cglD8w.js";import{E as M}from"./eye-BPpa2dX2.js";import{Z as $}from"./zap-BJD73Sl4.js";import"./utils-BBBj0rcX.js";import"./form-utils-5MXy8GNC.js";import"./trending-up-Il02X4LE.js";
/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=d("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),Y=d("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);m.integrations.Core;const B=m.integrations.Core.InvokeLLM;m.integrations.Core.SendEmail;const G=m.integrations.Core.UploadFile;m.integrations.Core.GenerateImage;const H=m.integrations.Core.ExtractDataFromUploadedFile;const X=new class{constructor(){this.workers=new Map,this.taskQueue=[],this.maxWorkers=navigator.hardwareConcurrency||4}getWorker(e){if(!this.workers.has(e))try{const a=new Worker(`/src/workers/${e}.js`,{type:"module"});this.workers.set(e,{worker:a,busy:!1,tasks:0})}catch(a){return null}return this.workers.get(e)}async executeTask(e,a,t,s={}){const{timeout:r=3e4}=s;return new Promise((s,i)=>{const l=this.getWorker(e);if(!l)return void i(new Error(`Worker ${e} not available`));const{worker:n}=l,o=`task_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,c=setTimeout(()=>{n.terminate(),this.workers.delete(e),i(new Error("Worker task timeout"))},r),d=e=>{const{type:a,result:t,error:r}=e.data;"ERROR"===a?(clearTimeout(c),n.removeEventListener("message",d),l.busy=!1,i(new Error(r))):(a.includes("COMPLETE")||a.includes("EXTRACTED"))&&(clearTimeout(c),n.removeEventListener("message",d),l.busy=!1,l.tasks++,s(t))};n.addEventListener("message",d),l.busy=!0,n.postMessage({type:a,data:t,taskId:o})})}async analyzePolicyText(e,a={}){return this.executeTask("analysisWorker","ANALYZE_POLICY",{text:e,options:a})}async calculateRiskScore(e,a={}){return this.executeTask("analysisWorker","CALCULATE_RISK_SCORE",{clauses:e,userProfile:a})}async extractClauses(e){return this.executeTask("analysisWorker","EXTRACT_CLAUSES",{text:e})}getWorkerStats(){const e={};return this.workers.forEach((a,t)=>{e[t]={busy:a.busy,tasksCompleted:a.tasks}}),e}terminateAll(){this.workers.forEach((e,a)=>{e.worker.terminate()}),this.workers.clear()}terminateWorker(e){const a=this.workers.get(e);a&&(a.worker.terminate(),this.workers.delete(e))}};function Z({onFileUpload:t}){const s=a.useRef(null),[l,n]=a.useState(!1);return e.jsx(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:e.jsx(i,{className:"p-8",children:e.jsxs("div",{className:"relative border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 "+(l?"border-blue-500 bg-blue-500/10":"border-gray-600 hover:border-gray-500"),onDragOver:e=>{e.preventDefault(),n(!0)},onDragLeave:e=>{e.preventDefault(),n(!1)},onDrop:e=>{e.preventDefault(),n(!1);const a=Array.from(e.dataTransfer.files);a.length>0&&t(a[0])},children:[e.jsx("input",{ref:s,type:"file",accept:".pdf,.doc,.docx,.txt",onChange:e=>{const a=Array.from(e.target.files);a.length>0&&t(a[0])},className:"hidden"}),e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Upload Privacy Agreement"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Drop your privacy policy document here or click to browse"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:e.jsxs(p,{onClick:()=>s.current?.click(),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Choose File"]})}),e.jsx("div",{className:"text-sm text-gray-500",children:"Supported formats: PDF, DOC, DOCX, TXT"})]})]})})})}function K({onAnalyze:t}){const[s,o]=a.useState(""),[c,d]=a.useState("");return e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-blue-400"}),"Analyze Privacy Policy URL"]})}),e.jsx(i,{children:e.jsxs(y.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onSubmit:e=>{e.preventDefault(),s.trim()&&t(s.trim(),c.trim())},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"url",className:"text-white",children:"Privacy Policy URL"}),e.jsx(P,{id:"url",type:"url",placeholder:"https://example.com/privacy-policy",value:s,onChange:e=>o(e.target.value),className:"bg-gray-800/50 border-gray-700 text-white placeholder-gray-400",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"title",className:"text-white",children:"Service Name (Optional)"}),e.jsx(P,{id:"title",type:"text",placeholder:"e.g., Facebook, Google, Amazon",value:c,onChange:e=>d(e.target.value),className:"bg-gray-800/50 border-gray-700 text-white placeholder-gray-400"})]}),e.jsxs(p,{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-medium py-3 rounded-xl",children:[e.jsx(g,{className:"w-5 h-5 mr-2"}),"Analyze Privacy Policy"]})]})})]})}const V=({label:a,granted:t})=>e.jsxs("div",{className:"flex items-center gap-2",children:[t?e.jsx(j,{className:"w-4 h-4 text-green-400"}):e.jsx(w,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-sm "+(t?"text-gray-300":"text-gray-500"),children:a})]});function J({agreement:a,onNewAnalysis:s}){const c=e=>{switch(e){case"critical":return"bg-red-500/20 text-red-400 border-red-500/30";case"high":return"bg-orange-500/20 text-orange-400 border-orange-500/30";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"low":return"bg-blue-500/20 text-blue-400 border-blue-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},d=e=>{switch(e){case"urgent":return"bg-red-500/20 text-red-400 border-red-500/30";case"high":return"bg-orange-500/20 text-orange-400 border-orange-500/30";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"low":return"bg-blue-500/20 text-blue-400 border-blue-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(r,{className:"bg-gradient-to-r from-gray-900 to-gray-800 border-gray-700/50 backdrop-blur-sm",children:e.jsxs(i,{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:a.title}),e.jsx("p",{className:"text-gray-400",children:a.company})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-4xl font-bold "+(m=a.risk_score,m>=80?"text-red-400":m>=60?"text-orange-400":m>=40?"text-yellow-400":"text-green-400"),children:[a.risk_score,"/100"]}),e.jsx(o,{className:`${(e=>e>=80?"bg-red-500/20 text-red-400 border-red-500/30":e>=60?"bg-orange-500/20 text-orange-400 border-orange-500/30":e>=40?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":"bg-green-500/20 text-green-400 border-green-500/30")(a.risk_score)} border`,children:(e=>e>=80?"Critical Risk":e>=60?"High Risk":e>=40?"Medium Risk":"Low Risk")(a.risk_score)})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Risk Score"}),e.jsx(x,{value:a.risk_score,className:"h-3"})]}),e.jsx("p",{className:"text-gray-300 mb-6",children:a.analysis_summary}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(p,{onClick:s,variant:"outline",className:"border-gray-700 text-gray-300",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Analyze Another"]}),e.jsx(t,{to:h("Dashboard"),children:e.jsxs(p,{variant:"outline",className:"border-gray-700 text-gray-300",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"View Dashboard"]})}),a.url&&e.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx(W,{className:"w-4 h-4"}),"View Original"]})]})]})})}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-blue-400"}),"Data Collection Breakdown"]})}),e.jsx(i,{children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{key:"contact_info",label:"Contact Info"},{key:"financial_info",label:"Financial Info"},{key:"health_info",label:"Health Info"},{key:"location_info",label:"Location Info"},{key:"biometric_info",label:"Biometric Info"},{key:"usage_data",label:"Usage Data"},{key:"device_info",label:"Device Info"},{key:"user_content",label:"User Content"}].map(t=>e.jsx(V,{label:t.label,granted:a.data_collection_breakdown?.[t.key]},t.key))})})]})}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-green-400"}),"Your Rights"]})}),e.jsxs(i,{className:"grid grid-cols-2 gap-2",children:[e.jsx(V,{label:"Data Access",granted:a.user_rights_summary?.data_access}),e.jsx(V,{label:"Data Deletion",granted:a.user_rights_summary?.data_deletion}),e.jsx(V,{label:"Data Portability",granted:a.user_rights_summary?.data_portability}),e.jsx(V,{label:"Opt-out of Sale",granted:a.user_rights_summary?.opt_out_of_sale})]})]})}),a.third_party_trackers&&a.third_party_trackers.length>0&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-purple-400"}),"Third-Party Sharing"]})}),e.jsx(i,{className:"flex flex-wrap gap-2",children:a.third_party_trackers.map((a,t)=>e.jsx(o,{variant:"outline",className:"border-purple-500/50 text-purple-400",children:a},t))})]})}),a.data_retention_policy&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-yellow-400"}),"Data Retention Policy"]})}),e.jsx(i,{children:e.jsx("p",{className:"text-white font-medium",children:a.data_retention_policy})})]})})]}),e.jsxs("div",{className:"space-y-6",children:[a.flagged_clauses&&a.flagged_clauses.length>0&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},children:e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-red-400"}),"Flagged Clauses (",a.flagged_clauses.length,")"]})}),e.jsx(i,{className:"space-y-4",children:a.flagged_clauses.map((a,t)=>e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700/50",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs(o,{className:`${c(a.risk_level)} border`,children:[a.risk_level," risk"]})}),e.jsxs("blockquote",{className:"text-gray-300 border-l-4 border-gray-600 pl-4 mb-3 italic",children:['"',a.clause_text,'"']}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-400",children:"Plain Language:"}),e.jsx("p",{className:"text-white",children:a.plain_language})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-400",children:"Why this matters:"}),e.jsx("p",{className:"text-gray-300",children:a.explanation})]}),a.what_if_scenario&&e.jsxs("div",{className:"p-3 bg-red-900/30 rounded-lg border border-red-500/30",children:[e.jsxs("span",{className:"text-sm font-medium text-red-400 flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),"What If Scenario:"]}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:a.what_if_scenario})]})]})]},t))})]})}),a.recommendations&&a.recommendations.length>0&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},children:e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-green-400"}),"Recommendations"]})}),e.jsx(i,{className:"space-y-4",children:a.recommendations.map((a,t)=>e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:a.action}),e.jsx(o,{className:`${d(a.priority)} border`,children:a.priority})]}),e.jsx("p",{className:"text-gray-300",children:a.description})]},t))})]})})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[a.opt_out_options&&a.opt_out_options.length>0&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-green-400"}),"Opt-out Options"]})}),e.jsx(i,{className:"space-y-4",children:a.opt_out_options.map((a,t)=>e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:a.type}),a.url&&e.jsx("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 transition-colors",children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-gray-300",children:a.instructions})]},t))})]})}),a.data_usage_categories&&a.data_usage_categories.length>0&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm h-full",children:[e.jsx(l,{children:e.jsxs(n,{className:"text-white flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-blue-400"}),"General Data Usage"]})}),e.jsx(i,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:a.data_usage_categories.map((a,t)=>e.jsx(o,{variant:"outline",className:"border-blue-500/50 text-blue-400",children:a.replace(/_/g," ")},t))})})]})})]})]});var m}function Q({onUpgrade:a,type:t="limit",customMessage:s}){const l={limit:{icon:b,title:"Analysis Limit Reached",message:"You've reached your monthly analysis limit. Upgrade to Premium for unlimited analyses.",buttonText:"Upgrade for $1.99/month",color:"orange"},feature:{icon:v,title:"Premium Feature",message:s||"This feature is available with Premium subscription.",buttonText:"Unlock Premium Features",color:"blue"},monitor:{icon:$,title:"Real-time Monitoring",message:"Enable 24/7 policy monitoring and instant alerts with Premium.",buttonText:"Enable Monitoring",color:"purple"}},n=l[t]||l.feature,o=n.icon;return e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:e.jsx(r,{className:`${{orange:"border-orange-500/30 bg-orange-500/10",blue:"border-blue-500/30 bg-blue-500/10",purple:"border-purple-500/30 bg-purple-500/10"}[n.color]} border backdrop-blur-sm`,children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800/50 flex items-center justify-center",children:e.jsx(o,{className:`w-6 h-6 ${{orange:"text-orange-400",blue:"text-blue-400",purple:"text-purple-400"}[n.color]}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-white mb-1",children:n.title}),e.jsx("p",{className:"text-gray-300 text-sm",children:n.message})]}),e.jsxs(p,{onClick:a,className:`${{orange:"bg-orange-600 hover:bg-orange-700",blue:"bg-blue-600 hover:bg-blue-700",purple:"bg-purple-600 hover:bg-purple-700"}[n.color]} text-white font-medium px-6 py-2 rounded-lg`,children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),n.buttonText]})]})})})})}function ee(){s();const[t,l]=a.useState("file"),[n,o]=a.useState(!1),[d,m]=a.useState(0),[g,u]=a.useState(""),[h,b]=a.useState(null),[f,j]=a.useState(null),[_,w]=a.useState(null),[v,P]=a.useState(!1);a.useEffect(()=>{S()},[]);const S=async()=>{try{const{data:e}=await N({action:"check_usage_limits"});w(e)}catch(e){}},E=async(e,a,t=null,s=null)=>{if(await(async()=>!(_&&!_.usage.can_analyze&&(P(!0),1)))()){o(!0),m(0),j(null),b(null);try{u("Extracting content..."),m(20),u("Analyzing text structure..."),m(30);const o=await(l=e,n={includeReadability:!0,extractKeyTerms:!0},X.analyzePolicyText(l,n));u("Extracting privacy clauses..."),m(35);const d=await(e=>X.extractClauses(e))(e);u("AI analyzing privacy risks..."),m(40);const y=`\n        You are PrivacyProtocol's AI engine, a world-class expert in privacy law and data protection. Your task is to perform a deep, detailed analysis of a privacy policy.\n\n        Analyze the following privacy agreement content and provide a comprehensive assessment. Be extremely thorough and detailed in your response.\n\n        CONTENT TO ANALYZE:\n        ${e}\n\n        Provide the analysis in a structured JSON format. Here are the required fields:\n\n        1.  **analysis_summary**: A concise, executive summary of the key findings and overall privacy posture.\n        2.  **flagged_clauses**: Identify problematic clauses. For each clause:\n            *   **clause_text**: The exact text of the clause.\n            *   **risk_level**: 'low', 'medium', 'high', or 'critical'.\n            *   **explanation**: A detailed explanation of why this clause is a risk.\n            *   **plain_language**: Translate the legalese into simple, easy-to-understand language.\n            *   **what_if_scenario**: Describe a realistic negative "what if" scenario that could result from this clause.\n        3.  **data_collection_breakdown**: A boolean checklist of specific data types collected. The keys are: "contact_info", "financial_info", "health_info", "location_info", "biometric_info", "usage_data", "device_info", "user_content".\n        4.  **data_usage_categories**: A list of general data usage categories from this enum: ["personal_info", "tracking", "advertising", "third_party_sharing", "data_selling", "profiling", "location", "biometric", "financial", "health"].\n        5.  **third_party_trackers**: A list of specific third-party companies, services, or trackers mentioned (e.g., "Google Analytics", "Meta Pixel").\n        6.  **data_retention_policy**: A brief summary of their data retention policy (e.g., "Indefinite", "Until account deletion", "90 days after inactivity").\n        7.  **user_rights_summary**: A boolean checklist of user rights explicitly granted. The keys are: "data_access", "data_deletion", "data_portability", "opt_out_of_sale".\n        8.  **recommendations**: A list of actionable recommendations for the user. For each recommendation:\n            *   **action**: A short title for the action.\n            *   **description**: A clear explanation of what to do.\n            *   **priority**: 'low', 'medium', 'high', or 'urgent'.\n            *   **category**: 'settings_change', 'account_action', 'awareness', or 'external_tool'.\n        9. **opt_out_options**: A list of available opt-out mechanisms. For each:\n            *   **type**: The type of opt-out (e.g., "Ad Personalization").\n            *   **url**: A direct URL if available.\n            *   **instructions**: How to perform the opt-out.\n\n        Your analysis must be rigorous, precise, and user-centric, prioritizing the user's digital sovereignty.\n      `,p=await B({prompt:y,response_json_schema:{type:"object",properties:{analysis_summary:{type:"string"},flagged_clauses:{type:"array",items:{type:"object",properties:{clause_text:{type:"string"},risk_level:{type:"string",enum:["low","medium","high","critical"]},explanation:{type:"string"},plain_language:{type:"string"},what_if_scenario:{type:"string"}},required:["clause_text","risk_level","explanation","plain_language","what_if_scenario"]}},data_collection_breakdown:{type:"object",properties:{contact_info:{type:"boolean"},financial_info:{type:"boolean"},health_info:{type:"boolean"},location_info:{type:"boolean"},biometric_info:{type:"boolean"},usage_data:{type:"boolean"},device_info:{type:"boolean"},user_content:{type:"boolean"}}},data_usage_categories:{type:"array",items:{type:"string",enum:["personal_info","tracking","advertising","third_party_sharing","data_selling","profiling","location","biometric","financial","health"]}},third_party_trackers:{type:"array",items:{type:"string"}},data_retention_policy:{type:"string"},user_rights_summary:{type:"object",properties:{data_access:{type:"boolean"},data_deletion:{type:"boolean"},data_portability:{type:"boolean"},opt_out_of_sale:{type:"boolean"}}},recommendations:{type:"array",items:{type:"object",properties:{action:{type:"string"},description:{type:"string"},priority:{type:"string",enum:["low","medium","high","urgent"]},category:{type:"string",enum:["settings_change","account_action","awareness","external_tool"]}}}},opt_out_options:{type:"array",items:{type:"object",properties:{type:{type:"string"},url:{type:"string"},instructions:{type:"string"}}}}},required:["analysis_summary","flagged_clauses","data_collection_breakdown","data_usage_categories","third_party_trackers","data_retention_policy","user_rights_summary","recommendations","opt_out_options"]}});u("Calculating personalized risk score..."),m(60);const g=await(r=d,X.calculateRiskScore(r,i)),{data:x}=await T({agreementData:p,preAnalysis:{textAnalysis:o,extractedClauses:d,webWorkerRiskAnalysis:g}});u("Generating insights..."),m(80),u("Saving analysis..."),m(90);const h={title:a,company:a,url:t||"",file_url:s||"",risk_score:x.risk_score,analysis_summary:p.analysis_summary,flagged_clauses:p.flagged_clauses||[],data_usage_categories:p.data_usage_categories||[],data_collection_breakdown:p.data_collection_breakdown||{},third_party_trackers:p.third_party_trackers||[],data_retention_policy:p.data_retention_policy||"Not specified",user_rights_summary:p.user_rights_summary||{},recommendations:p.recommendations||[],opt_out_options:p.opt_out_options||[],textAnalysis:o,extractedClauses:d,webWorkerRiskAnalysis:g,status:"completed"},f=await c.create(h);_?.subscription&&(await N({action:"increment_usage",data:{subscription_id:_.subscription.id}}),await S()),m(100),b(f),u("Analysis complete!")}catch(d){j(d.message||"Failed to analyze privacy agreement")}finally{o(!1)}var r,i,l,n}else o(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsx("div",{className:"text-center space-y-4",children:e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-2",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-indigo-400 bg-clip-text text-transparent",children:"Privacy Agreement Analyzer"}),e.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:"Upload documents or paste URLs to decode privacy policies with AI-powered analysis"})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"bg-gray-900/50 p-1 rounded-xl border border-gray-800/50",children:[e.jsxs(p,{variant:"file"===t?"default":"ghost",onClick:()=>l("file"),className:"file"===t?"bg-blue-500 hover:bg-blue-600":"text-gray-400 hover:text-white",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Upload File"]}),e.jsxs(p,{variant:"url"===t?"default":"ghost",onClick:()=>l("url"),className:"url"===t?"bg-blue-500 hover:bg-blue-600":"text-gray-400 hover:text-white",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Analyze URL"]})]})}),_&&!_.usage.can_analyze&&e.jsx(Q,{type:"limit",onUpgrade:()=>P(!0)}),f&&e.jsxs(U,{className:"border-red-500/50 bg-red-500/10",children:[e.jsx(k,{className:"h-4 w-4 text-red-400"}),e.jsx(F,{className:"text-red-400",children:f})]}),e.jsxs(A,{mode:"wait",children:[!n&&!h&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:"file"===t?e.jsx(Z,{onFileUpload:async e=>{try{const{file_url:a}=await G({file:e}),t=await H({file_url:a,json_schema:{type:"object",properties:{content:{type:"string",description:"Full text content of the privacy agreement"},title:{type:"string",description:"Title or company name from the document"}}}});if("success"!==t.status||!t.output)throw new Error("Could not extract content from file");await E(t.output.content,t.output.title||e.name,null,a)}catch(a){j(a.message||"Failed to process file")}}}):e.jsx(K,{onAnalyze:async(e,a)=>{try{const t=`\n        Please fetch and extract the complete privacy policy content from this URL: ${e}\n\n        Extract the full text content of the privacy policy or terms of service.\n        Focus on getting all the important privacy-related sections.\n      `,s=await B({prompt:t,add_context_from_internet:!0,response_json_schema:{type:"object",properties:{content:{type:"string",description:"Full privacy policy content"},extracted_title:{type:"string",description:"Company or service name"}}}});if(!s.content)throw new Error("Could not fetch privacy policy content from URL");await E(s.content,a||s.extracted_title||"Privacy Policy",e)}catch(t){j(t.message||"Failed to analyze URL")}}})}),n&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx(r,{className:"bg-gray-900/50 border-gray-800/50 backdrop-blur-sm",children:e.jsx(i,{className:"p-8",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center",children:e.jsx(C,{className:"w-8 h-8 text-white animate-pulse"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"AI Analysis In Progress"}),e.jsx("p",{className:"text-gray-400",children:g})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{value:d,className:"h-2"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[d,"% Complete"]})]})]})})})}),h&&e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx(J,{agreement:h,onNewAnalysis:()=>{b(null),j(null),m(0),u(""),S()}})})]}),e.jsx(I,{open:v,onClose:()=>P(!1)})]})})}export{ee as default};
